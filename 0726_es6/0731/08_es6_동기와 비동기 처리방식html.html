<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>08_es6_동기와 비동기 처리방식</title>
</head>
<body>
  <h2>08_es6_동기와 비동기 처리방식</h2>
  <h3>1. 동기(synchronous) 방식</h3>
  <p>데이터의 요청과 결과가 한 자리에서 동시에 일어나는 것.</p>
  <p>사용자가 데이터를 서버에게 요청하면 그 서버가 데이터 요청에 따른 응답을 사용자에게 다시 리턴해주기 전까지 사용자는 다른 활동을 할 수 없으며 기다려야 한다.</p>
  <p>직원이 1명인 카페에서 A고객이 아메리카노를 주문하면 아메리카노를 만들기 전까지 다음 주문을 받을 수 없는 방식</p>

  <h3>2. 비동기(Asynchronous)방식 - 동시에 일어나지 않는다는 것.</h3>
  <p>서버에게 데이터를 요청한 후 요청에 따른 응답을 계속 기다리지 않아도 되며 다른 외부활동을 수행하여도 되고 서버에게 다른 요청사항을 보내도 상관없습니다.</p>
  <p>직원 여러명인 카페에서 A, B, C, D고객의 음료를 각각 주문 받아 제조하는 방식</p>

  <h3>비동기 방식의 사례</h3>
  <ul>
    <li>DOM Element의 이벤트 핸들러: 마우스, 키보드 입력, 페이지 로딩 등등</li>
    <li>타이머: 타이머 API(setTimeout 등), 애니메이션 API(requestAnimationFrame)</li>
    <li>서버에 자원요청 및 응답: fetch API, AJAX</li>
  </ul>

  <h3>비동기면 좋은 작업들</h3>
  <ul>
    <li>백그라운드 실행, 로딩 창 실행</li>
    <li>서버로 요청을 보내고 응답을 기다리는 작업</li>
    <li>대용량의 데이터를 로딩하거나 처리하는 작업</li>
  </ul>

  <h3>비동기 방식을 위한 방법 3가지</h3>
  <ul>
    <li>callback function</li>
    <li>promise</li>
    <li>async, await</li>
  </ul>

  <h3>비동기 방식으로 데이터 처리하기</h3>
  <p>주의사항 : 함수를 인수로 전달할 때 괄호는 작성하지 않는다.</p>

  <h4>일반함수 값 : <span id="test01"></span></h4>
  <h4>setTimeOut 값 : <span id="test02"></span></h4>

  <div id="clock"></div>

  <script>
    //setTimeout(test, 3000); //맞는 문법
    //setTimeout(test(), 3000); //틀린 문법

    //문서객체선언
    const test01 = document.getElementById('test01');
    const test02 = document.getElementById('test02');
    const clock = document.getElementById('clock');

    function output1(){
      test01.innerHTML='저는 일반함수입니다.';
    }

    function output2(){
      test02.innerHTML='저는  setTimeout에서 실행되었습니다.';
    }

    //함수실행
    output1();
    setTimeout(output2, 2000);

    function startTime(){ //사용자 정의 함수
      let today = new Date();
      // document.write(today.getHours()+':'); //시
      // document.write(today.getMinutes()+':'); //분
      // document.write(today.getSeconds()); //초
      let h = today.getHours(); //시
      let m = today.getMinutes(); //분
      let s = today.getSeconds(); //초

      h = checknum(h);
      m = checknum(m);
      s = checknum(s);

      document.getElementById('clock').innerHTML=h+':'+m+':'+s; //시:분:초

      let t = setTimeout(startTime, 500); //0.5초마다 함수가 호출
    }
    //함수명으로 호출하여 내용출력
    startTime();

    //시, 분, 초가 1-9까지일 경우 숫자앞에 문자 '0'을 붙이기
    function checknum(i){
      if(i<10){
        i = '0' + i;
      }
      return i; //조건문을 종료하고 변수 i값을 위 startTime함수에 넘겨준다.(리턴)
    }
  </script>
</body>
</html>